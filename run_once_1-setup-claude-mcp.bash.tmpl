#!/usr/bin/env bash

# Setup Claude Code MCP servers
# This runs only once after Claude is installed via mise

# Check if claude command is available
if ! command -v claude &> /dev/null; then
    echo "Claude Code not found in PATH, skipping MCP setup"
    exit 0
fi

# Helper function to add MCP server, ignoring "already exists" errors
add_mcp_server() {
    local server_name="$1"
    local command="$2"

    if claude mcp add -s user "$server_name" -- $command 2>&1 | grep -q "already exists in user config"; then
        return 0  # Success, server already exists
    fi
}

# Add Context7 MCP server
add_mcp_server "context7" "npx -y @upstash/context7-mcp"