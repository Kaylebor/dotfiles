# AGENTS.md

Guidance for automated coding agents working inside this chezmoi-managed dotfiles repo.

## Core Workflows
- Always edit sources under `~/.local/share/chezmoi` (this repo) rather than generated files in `$HOME`.
- Use `chezmoi diff` to preview and `chezmoi apply` to deploy changes after validating.
- Prefer `apply_patch` for surgical edits; large autogenerated files (e.g., formatter output) can instead be replaced wholesale.

## Chezmoi Reference
- Context7 library ID for official documentation: `/twpayne/chezmoi`.
- Helpful commands:
  - `chezmoi data` – inspect available template variables.
  - `chezmoi execute-template <file>` – render a template for verification.
  - `chezmoi add --template <path>` – convert new files into templates when customization is required.
- Template primitives used in this repo:
  - `.chezmoi.os` / `.chezmoi.osRelease` for platform-specific conditionals.
  - `lookPath` and `stat` helpers to guard optional dependencies.
  - Shared partials in `.chezmoitemplates/` for reusable snippets.

## OS-Specific Files
- macOS-only assets live under `Library/` and are gated with `{{ if eq .chezmoi.os "darwin" }}` blocks plus matching entries in `.chezmoiignore`.
- Linux-only artifacts (Hyprland, systemd, etc.) are ignored automatically on other platforms via the same template pattern.

## SSH Keychain Loader (macOS)
- Scripts under `dot_local/bin/executable_*` become `~/.local/bin/*` at apply time and are installed with executable permissions.
- `Library/LaunchAgents/*.plist.tmpl` files create per-user launchd jobs; ensure `RunAtLoad` is true so helpers run once each login session.
- When adding new macOS launchd jobs, remember to ignore the generated targets on non-darwin systems in `.chezmoiignore`.
