#!/bin/bash
# Setup tool integrations for nushell
{{- if lookPath "carapace" }}
# hash: {{ output "sh" "-c" "carapace --version 2>&1" | sha256sum }}
{{- end }}
{{- if lookPath "mise" }}
# hash: {{ output "mise" "--version" | sha256sum }}
{{- end }}

set -euo pipefail

# Create necessary directories
mkdir -p "$HOME/.cache/carapace"
NU_DATA_DIR="${XDG_DATA_HOME:-$HOME/.local/share}/nushell"
mkdir -p "$NU_DATA_DIR/vendor/autoload"

# Initialize Mise for nushell
{{- if lookPath "mise" }}
echo "Generating Mise activation for nushell..."
mise activate nu > "$NU_DATA_DIR/vendor/autoload/mise.nu"
{{- end }}

# Initialize Carapace completions for nushell
{{- if lookPath "carapace" }}
echo "Generating Carapace completions for nushell..."
carapace _carapace nushell > "$HOME/.cache/carapace/init.nu"
{{- end }}
